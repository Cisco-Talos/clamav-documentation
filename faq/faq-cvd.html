<!DOCTYPE HTML>
<html lang="en" class="clamav sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Signature Database (CVD) - ClamAV Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="An open source malware detection toolkit and antivirus engine.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "clamav";
            const default_dark_theme = "clamav";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('clamav')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="clamav">Dark</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="clamav_light">Light</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ClamAV Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="clamav-virus-database-faq"><a class="header" href="#clamav-virus-database-faq">ClamAV Virus Database FAQ</a></h1>
<p>The following FAQ should help you understand how ClamAV CVD signature databases work and any issues you may experience working with them.</p>
<p>If you're unable to find an answer to your question in the FAQ, you can seek help in <a href="https://www.clamav.net/contact.html#ml">our clamav-users mailing list</a>, on our <a href="https://discord.gg/6vNAqWnVgw">Discord server</a>, or by submitting an <a href="https://github.com/Cisco-Talos/clamav/issues">issue on GitHub</a>. The mailing list archives and existing Github issues (open or closed) may also have an answer to your question.</p>
<p>Please consider contributing answered questions back to this FAQ, and improving the quality of these answers, by submitting pull requests to <a href="https://github.com/Cisco-Talos/clamav-documentation">our documentation source repository</a>.</p>
<h2 id="how-do-i-keep-my-virus-database-up-to-date"><a class="header" href="#how-do-i-keep-my-virus-database-up-to-date">How do I keep my virus database up to date?</a></h2>
<p>ClamAV comes with <em>FreshClam</em>, a tool which periodically checks for new database releases and keeps your database up to date.</p>
<h2 id="how-often-is-the-virus-database-updated"><a class="header" href="#how-often-is-the-virus-database-updated">How often is the virus database updated?</a></h2>
<p>The virus database is usually updated once or twice per day. Sign up for our <a href="https://lists.clamav.net/mailman/listinfo/clamav-virusdb">VirusDB mailing list</a> to see our response times to new threats. The virusdb team tries to keep up with the latest threats in the wild. You can contribute to make the virusdb updating process more efficient by submitting samples of viruses via our "<a href="https://www.clamav.net/contact">Contact</a>" page on ClamAV.net.</p>
<h2 id="the-last-cvd-update-crashed-my-clamav-installation-why"><a class="header" href="#the-last-cvd-update-crashed-my-clamav-installation-why">The last CVD update crashed my ClamAV installation. Why?</a></h2>
<p>Before publishing a CVD update, we verify that it can be correctly loaded by the last two stable release series of ClamAV.</p>
<h2 id="the-last-cvd-update-detects-a-lot-of-false-positives-on-my-system-why"><a class="header" href="#the-last-cvd-update-detects-a-lot-of-false-positives-on-my-system-why">The last CVD update detects a lot of false positives on my system. Why?</a></h2>
<p>Before publishing a CVD update, we test it for false positives using the latest stable release of ClamAV. If you want to avoid problems with false positives, you must run the latest stable version of ClamAV.  Please stay tuned to our <a href="faq-eol.html">EOL policy</a> for what versions are actively supported.</p>
<h2 id="i-tried-to-submit-a-sample-through-the-web-interface-but-it-said-the-sample-is-already-recognized-by-clamav-my-clamscan-tells-me-its-not-i-have-already-updated-my-database-and-clamav-engine-whats-wrong-with-my-setup"><a class="header" href="#i-tried-to-submit-a-sample-through-the-web-interface-but-it-said-the-sample-is-already-recognized-by-clamav-my-clamscan-tells-me-its-not-i-have-already-updated-my-database-and-clamav-engine-whats-wrong-with-my-setup">I tried to submit a sample through the web interface, but it said the sample is already recognized by ClamAV. My ClamScan tells me it's not. I have already updated my database and ClamAV engine, what's wrong with my setup?</a></h2>
<p>Please run ClamScan with the <code>--alert-broken</code> option. Also check that FreshClam and ClamScan are using the same path for storing/reading the database.</p>
<h2 id="i-found-an-infected-file-in-my-hdusbmailbox-but-clamav-doesnt-recognize-it-yet-can-you-help-me"><a class="header" href="#i-found-an-infected-file-in-my-hdusbmailbox-but-clamav-doesnt-recognize-it-yet-can-you-help-me">I found an infected file in my HD/USB/mailbox, but ClamAV doesn't recognize it yet. Can you help me?</a></h2>
<p>Our virus database is kept up to date with the help of the community. Whenever you find a new virus which is not detected by ClamAV you should <a href="https://www.clamav.net/reports/malware">complete this form</a>. The virusdb team will review your submission and update the database if necessary. Before submitting a new sample: - check that the value of <code>DatabaseDirectory</code>, in both <code>clamd.conf</code> and <code>freshclam.conf</code>, is the same - and update your database by running FreshClam to ensure you've scanned it with the latest virus database.</p>
<h2 id="im-running-clamav-on-a-lot-of-clients-on-my-local-network-can-i-serve-the-cvd-files-from-a-local-server-so-that-each-client-doesnt-have-to-download-them-from-your-servers"><a class="header" href="#im-running-clamav-on-a-lot-of-clients-on-my-local-network-can-i-serve-the-cvd-files-from-a-local-server-so-that-each-client-doesnt-have-to-download-them-from-your-servers">I'm running ClamAV on a lot of clients on my local network. Can I serve the cvd files from a local server so that each client doesn't have to download them from your servers?</a></h2>
<p>Sure, you can find more details on our <a href="../appendix/CvdPrivateMirror.html">Private Local Mirror page</a>.</p>
<ol>
<li>
<p>If you want to take advantage of incremental updates, install a proxy server and then configure your FreshClam clients to use it (watch for the HTTPProxyServer parameter in <code>freshclam.conf</code>).</p>
</li>
<li>
<p>The second possible solution is to:</p>
</li>
</ol>
<ul>
<li>
<p>Configure a local webserver on one of your machines (say <code>machine1.mylan</code>)</p>
</li>
<li>
<p>Let FreshClam download the <code>*.cvd</code> files from <a href="http://database.clamav.net">http://database.clamav.net</a> to the webserver's <em>DocumentRoot</em>.</p>
</li>
<li>
<p>Finally, change <code>freshclam.conf</code> on your clients so that it includes:</p>
<pre><code class="language-ini">DatabaseMirror machine1.mylan

ScriptedUpdates off
</code></pre>
<p>First the database will be downloaded to the local webserver and then the other clients on the network will update their copy of the database from it.</p>
<p><em>Important</em>:  For this to work, you have to add <code>ScriptedUpdates off</code> on all of your machines!</p>
</li>
</ul>
<h2 id="i-cant-wait-for-you-to-update-the-database-i-need-to-use-the-new-signature-now"><a class="header" href="#i-cant-wait-for-you-to-update-the-database-i-need-to-use-the-new-signature-now">I can't wait for you to update the database! I need to use the new signature NOW!</a></h2>
<p>No problem, save your own signatures in a text file with the appropriate extension (see <a href="../manual/Signatures.html">our signature writing documentation</a> for more information). Put the signature files in the same directory where the <code>.cvd</code> files are located. This is typically <code>/usr/local/share/clamav</code> or <code>/var/lib/clamav</code>. ClamAV will load it after the official <code>.cvd</code> files. You do not need to sign your custom database files.</p>
<h2 id="can-i-download-the-virus-database-manually"><a class="header" href="#can-i-download-the-virus-database-manually">Can I download the virus database manually?</a></h2>
<p>This practice is discouraged, please use either FreshClam or CVDUpdate to update your definitions.  Please check out our <a href="faq-freshclam.html">FreshClam FAQ</a> and our <a href="../appendix/CvdPrivateMirror.html">Private Mirror Documentation</a> for further information and links to CVDUpdate.</p>
<h2 id="i-am-getting-error-codes-such-as-403-429-etc-when-freshclam-or-other-update-system-attempts-to-download-updates"><a class="header" href="#i-am-getting-error-codes-such-as-403-429-etc-when-freshclam-or-other-update-system-attempts-to-download-updates">I am getting error codes such as 403, 429, etc when FreshClam (or other update system) attempts to download updates</a></h2>
<p>Are you attempting to download <code>safebrowsing.cvd</code> and getting a 403?  If so, <a href="https://blog.clamav.net/2021/04/are-you-still-attempting-to-download.html">take a look at this blog post</a>, otherwise check out our <a href="faq-freshclam.html">Freshclam FAQ</a> under the section on "Error Codes".</p>
<hr />
<p>For other questions regarding issues with FreshClam, see our <a href="faq-troubleshoot.html">FreshClam Troubleshooting FAQ</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../faq/faq-freshclam.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../faq/faq-malware-fp-reports.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../faq/faq-freshclam.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../faq/faq-malware-fp-reports.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../editor.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
