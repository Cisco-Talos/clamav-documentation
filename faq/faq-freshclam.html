<!DOCTYPE HTML>
<html lang="en" class="clamav sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>FreshClam (Signature Updater) - ClamAV Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="An open source malware detection toolkit and antivirus engine.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "clamav";
            const default_dark_theme = "clamav";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('clamav')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="clamav">Dark</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="clamav_light">Light</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ClamAV Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="freshclam-faq"><a class="header" href="#freshclam-faq">FreshClam FAQ</a></h1>
<p>The following FAQ should help you understand why <code>freshclam</code> may have failed to fetch the latest updates.</p>
<p>If you're unable to find an answer to your question in the FAQ, you can seek help in <a href="https://www.clamav.net/contact.html#ml">our clamav-users mailing list</a>, on our <a href="https://discord.gg/6vNAqWnVgw">Discord server</a>, or by submitting an <a href="https://github.com/Cisco-Talos/clamav/issues">issue on GitHub</a>. The mailing list archives and existing Github issues (open or closed) may also have an answer to your question.</p>
<p>Please consider contributing answered questions back to this FAQ, and improving the quality of these answers, by submitting pull requests to <a href="https://github.com/Cisco-Talos/clamav-documentation">our documentation source repository</a>.</p>
<h2 id="failed-to-get-information-about-user-clamav"><a class="header" href="#failed-to-get-information-about-user-clamav">Failed to get information about user "clamav"</a></h2>
<p>If you've installed ClamAV and are running Freshclam as root or with <code>sudo</code> but don't have a <code>clamav</code> user account for Freshclam to run as, you may encounter this error:</p>
<pre><code>ERROR: Failed to get information about user "clamav".
Create the "clamav" user account for freshclam to use, or set the DatabaseOwner config option in freshclam.conf to a different user.
For more information, see https://docs.clamav.net/manual/Installing/Installing-from-source-Unix.html
ERROR: Initialization error!
</code></pre>
<p>You can resolve this issue by following these steps to <a href="https://docs.clamav.net/manual/Installing/Add-clamav-user.html">create a <code>clamav</code> service account</a>.</p>
<h2 id="cant-create-freshclamdat-in-usrlocalshareclamav"><a class="header" href="#cant-create-freshclamdat-in-usrlocalshareclamav">Can't create freshclam.dat in /usr/local/share/clamav</a></h2>
<p>If the database directory exists but is not owned by the user account that Freshclam is being run as, you may encounter this error:</p>
<pre><code>ERROR: Can't create freshclam.dat in /usr/local/share/clamav
Hint: The database directory must be writable for UID 1000 or GID 1000
ERROR: Failed to save freshclam.dat!
WARNING: Failed to create a new freshclam.dat!
ERROR: initialize: libfreshclam init failed.
ERROR: Initialization error!
</code></pre>
<p>To resolve this issue, change ownership of the directory to the appropriate user account.</p>
<p>For example if you're running Freshclam under your user account "bob", something like this may resolve the issue:</p>
<pre><code class="language-bash">sudo chown -R bob /usr/local/share/clamav
</code></pre>
<p>If running Freshclam as root (or with <code>sudo</code>), then Freshclam will try to automatically switch to run as the <code>clamav</code> user, or whichever user is specified as the <code>DatabaseOwner</code> in <code>freshclam.conf</code>. Run this to resolve the issue:</p>
<pre><code class="language-bash">sudo chown -R clamav /usr/local/share/clamav
</code></pre>
<h2 id="problem-with-the-ssl-ca-cert"><a class="header" href="#problem-with-the-ssl-ca-cert">Problem with the SSL CA cert</a></h2>
<p>On Linux/Unix systems, Freshclam uses openssl to validate certificates for TLS connections. It relies on finding the openssl CA bundle in the default path. You may encounter the following error if you're missing the <code>ca-certificates</code> package, or on some distributions where the path to the CA bundle has been customized:</p>
<pre><code>WARNING: Download failed (77) WARNING:  Message: Problem with the SSL CA cert (path? access rights?
WARNING: Can't download daily.cvd from https://database.clamav.net/daily.cvd
</code></pre>
<p>First you may try installing the <code>ca-certificates</code> package. If that is already installed, or the issue persists, then you may need to set the <code>CURL_CA_BUNDLE</code> environment variable to direct Freshclam to the path of the CA bundle on your system.</p>
<p>For example, on openSUSE you may need to set <code>CURL_CA_BUNDLE=/var/lib/ca-certificates/ca-bundle.pem</code>. You can test this by running:</p>
<pre><code class="language-bash">CURL_CA_BUNDLE=/var/lib/ca-certificates/ca-bundle.pem freshclam
</code></pre>
<p>If this resolves the issue, you may wish to export the <code>CURL_CA_BUNDLE</code> variable in your <code>.bashrc</code> file or the equivalent for your shell.</p>
<blockquote>
<p><em>Tip</em>: The <code>CURL_CA_BUNDLE</code> variable is also used by ClamSubmit.</p>
</blockquote>
<h2 id="invalid-dns-reply-falling-back-to-http-mode-or-error-cant-query-currentcvdclamavnet"><a class="header" href="#invalid-dns-reply-falling-back-to-http-mode-or-error-cant-query-currentcvdclamavnet">Invalid DNS reply. Falling back to HTTP mode or ERROR: Can't query current.cvd.clamav.net</a></h2>
<p>There is a problem with your DNS server. Please check the entries in <code>/etc/resolv.conf</code> and verify that you can resolve the <code>TXT</code> record manually:</p>
<p><code>$ host -t txt current.cvd.clamav.net</code></p>
<p>If you can't, it means your network is broken. You'll be still able to download the updates, but you'll waste a lot of bandwidth checking for updates. Please note that some not RFC compliant DNS servers (namely the one shipped with the <em>Alcatel</em> (now <em>Thomson</em>) <em>SpeedTouch 510 modem</em>) can't resolve <code>TXT</code> record. If that's the case, please recompile ClamAV with the flag <code>--enable-dns-fix</code>.</p>
<h2 id="error-connection-with--failed"><a class="header" href="#error-connection-with--failed">ERROR: Connection with ??? failed</a></h2>
<p>Either your dns servers are not working or you are blocking <code>port 53/tcp</code>. You should manually check that you can resolve hostnames with:</p>
<p><code>$ host database.clamav.net</code></p>
<p>If it doesn't work, check your dns settings in <code>/etc/resolv.conf</code>. If it works, check that you can receive dns answers longer than 512 bytes, e.g. check that your firewall is not blocking packets which originate from <code>port 53/tcp</code>. An easy way to find it out is:</p>
<p><code>$ dig @ns1.clamav.net db.us.big.clamav.net</code></p>
<h2 id="warning-incremental-update-failed-trying-to-download-dailycvd"><a class="header" href="#warning-incremental-update-failed-trying-to-download-dailycvd">WARNING: Incremental update failed, trying to download daily.cvd</a></h2>
<p>For some reason, incremental update failed. FreshClam can recover from this situation by downloading the whole daily.cvd.</p>
<h2 id="database-update-process-failed-downloaded-database-had-lower-version-than-advertised"><a class="header" href="#database-update-process-failed-downloaded-database-had-lower-version-than-advertised">Database update process failed: Downloaded database had lower version than advertised</a></h2>
<p>For some reason, the content delivery network is not serving the latest updates yet. If you experience this problem, please report the issue on <a href="https://github.com/Cisco-Talos/clamav-devel/issues">GitHub Issues</a>.</p>
<h2 id="update-failed-your-network-may-be-down-or-the-clamav-database-content-delivery-network-is-experiencing-an-outage"><a class="header" href="#update-failed-your-network-may-be-down-or-the-clamav-database-content-delivery-network-is-experiencing-an-outage">Update failed. Your network may be down or the ClamAV database content delivery network is experiencing an outage</a></h2>
<p>It's not your lucky day. Your network may be down or the ClamAV database content delivery network is experiencing an outage. Please wait a few minutes and try again. Remember to pass the <code>-v</code> option to freshclam.</p>
<h2 id="update-failed-updating-too-frequently-with-an-outdated-version"><a class="header" href="#update-failed-updating-too-frequently-with-an-outdated-version">Update failed. Updating too frequently with an outdated version</a></h2>
<p>Starting from ClamAV 0.9x, whenever your ClamAV engine becomes outdated and the difference between the functionality level required by the CVD and the functionality level supported by your ClamAV engine is more than 3, freshclam will refuse to check for updates more often than 6 times per day.</p>
<p>The reason for this is that bandwidth can be expensive. It is not helpful to generate extra traffic on our content delivery network if you cannot take advantage of all the signatures anyway. If you really care about catching as much malware as possible and you want to check for updates more often than 6 times per day, then you should also not run such an old version of ClamAV.</p>
<h2 id="your-clamav-installation-is-outdated"><a class="header" href="#your-clamav-installation-is-outdated">Your ClamAV installation is OUTDATED</a></h2>
<p>This message does NOT indicate that you are unable to download the latest CVD update! You'll get this message whenever a new version of ClamAV is released. In order to detect all the latest viruses, it's not enough to keep your database up to date. You also need to run the latest version of the scanner.</p>
<h2 id="warning-current-functionality-level--1-required--2"><a class="header" href="#warning-current-functionality-level--1-required--2">WARNING: Current functionality level = 1, required = 2</a></h2>
<p>The functionality level of the database determines which scanner engine version is required to use all of its signatures. If you don't upgrade immediately you will still be able to download the latest CVD updates but the engine won't be able to use ALL of them.</p>
<h2 id="ignoring-mirror-ip-has-connected-too-many-times-with-an-outdated-version"><a class="header" href="#ignoring-mirror-ip-has-connected-too-many-times-with-an-outdated-version">Ignoring mirror &lt;IP&gt; (has connected too many times with an outdated version)</a></h2>
<p>If you are experiencing this problem, please do the following:  Stop the <code>freshclam</code> daemon if it's running, delete both <code>mirrors.dat</code> and <code>daily.cvd</code>, then restart the <code>freshclam</code> daemon. FreshClam will then download a new <code>daily.cvd</code> and will be up-to-date.</p>
<h2 id="http-error-codes"><a class="header" href="#http-error-codes">HTTP Error Codes</a></h2>
<p>If you are receiving a 403, 503, or 1020 error codes when downloading from Cloudflare, then you are either explicitly blocked, using an <a href="faq-eol.html">EOL'ed version of ClamAV</a> or you are downloading incorrectly.</p>
<p>If FreshClam is failing and you're not sure why, you may run <code>freshclam -v</code> for "Verbose Mode" to see the HTTP request &amp; response details (ClamAV 0.102+).</p>
<p>After checking that you are using a current version of ClamAV, please discontinue whatever method of download you are using and immediately move to using either FreshClam or <a href="https://github.com/Cisco-Talos/cvdupdate">cvdupdate</a>. These are the two supported methods for downloading AV updates from ClamAV. All other methods may be rate limited, or blocked at our discretion. Use of Wget, Curl, or other command line tools that are scripted are explicitly denied.</p>
<p>If you are receiving a 429, that means you are rate limited.  You're downloading too fast or too much.  Please use Freshclam or <a href="https://github.com/micahsnyder/cvdupdate">cvdupdate</a>. If you are using a shared hosting provider, like Amazon AWS, Google Cloud Computing, Oracle, Azure, etc, you will most likely be rate limited, however cvdupdate should handle this gracefully.  If you continue to receive these, we recommend you try from a different external IP address.</p>
<p>If you are receiving a 403 specifically on the safebrowsing.cvd file, please read <a href="https://blog.clamav.net/2021/04/are-you-still-attempting-to-download.html">this blog post</a> immediately!</p>
<p>Are you running a version of FreshClam/ClamAV lower than <code>1.0</code>? If so, you should immediately upgrade to at least <code>1.0.9</code>.</p>
<p>If you have checked all of the above and you are still seeing errors, please open a ticket using the below link.</p>
<h2 id="for-all-other-database-update-related-failures"><a class="header" href="#for-all-other-database-update-related-failures">For all other database update related failures</a></h2>
<p>Please report freshclam update failures or issues on <a href="https://github.com/Cisco-Talos/clamav-devel/issues">GitHub Issues</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../faq/faq-whichversion.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../faq/faq-cvd.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../faq/faq-whichversion.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../faq/faq-cvd.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../editor.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
